# HELK fortinet filter
# HELK build Stage: Alpha
# Author: Paolo Di Prodi (@priamai)
# License: GPL-3.0

filter
{
  if [type] == "fortinet-fortigate" {
    mutate
    {
    gsub =>["message", ": ", ":","message", "^<[0-9][0-9][0-9]>", ""]
    }
    kv
    {
    field_split => ""," "
    source => "message"
    add_field => { 
      "event_original_time" => "%{date}:%{time}"
    }
    date { match => ["event_original_time","yyyy-MM-dd:HH:mm:ss"]}
  }
}